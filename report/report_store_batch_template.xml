<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
    <template id="report_store_batch_template" t-name="store_product_batch.report_store_batch_template">
      <t t-call="web.html_container">
        <t t-call="web.internal_layout">
          <t t-if="data">
            <t t-set="branches" t-value="data['branches']"/>

            <t t-foreach="branches" t-as="branch">
              <!-- Branch Header -->
              <div class="card mb-5">
                <div class="card-header bg-primary text-white">
                  <h3 class="mb-0">Branch: <t t-esc="branch['branch_name']"/></h3>
                  <p class="mb-0">Total Consumed: <strong><t t-esc="branch['total_consumed']"/></strong> |
                  Total Earned: <strong><t t-esc="branch['total_earned']"/></strong></p>
                </div>

                <div class="card-body">

                  <!-- Locations by Consumed Quantity -->
                  <div class="mb-4">
                    <h4 class="text-info">Top Locations by Consumed Quantity</h4>
                    <table class="table table-bordered table-hover">
                      <thead><tr><th>Location</th><th>Consumed Qty</th></tr></thead>
                      <tbody>
                        <t t-foreach="branch['location_by_qty']" t-as="loc">
                          <tr>
                            <td><t t-esc="loc[0]"/></td>
                            <td><t t-esc="loc[1]"/></td>
                          </tr>
                        </t>
                      </tbody>
                    </table>
                  </div>

                  <!-- Locations by Earned Amount -->
                  <div class="mb-4">
                    <h4 class="text-secondary">Top Locations by Earned Amount</h4>
                    <table class="table table-bordered table-hover">
                      <thead><tr><th>Location</th><th>Earned Amount</th></tr></thead>
                      <tbody>
                        <t t-foreach="branch['location_by_earned']" t-as="loc">
                          <tr>
                            <td><t t-esc="loc[0]"/></td>
                            <td><t t-esc="loc[1]"/></td>
                          </tr>
                        </t>
                      </tbody>
                    </table>
                  </div>

                  <!-- Product Summary -->
                  <div class="mb-4">
                    <h4 class="text-success">Top Products</h4>
                    <table class="table table-bordered table-hover">
                      <thead><tr><th>Product</th><th>Consumed Qty</th></tr></thead>
                      <tbody>
                        <t t-foreach="branch['product_summary']" t-as="prod">
                          <tr>
                            <td><t t-esc="prod[0]"/></td>
                            <td><t t-esc="prod[1]"/></td>
                          </tr>
                        </t>
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </t>
          </t>
        </t>
      </t>
    </template>
 </data>
  
</odoo>
